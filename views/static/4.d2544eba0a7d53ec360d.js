webpackJsonp([4],{1377:function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=r(3),u=a(n),s=r(120),c=a(s),d=r(62),i=a(d),o=r(119),p=a(o),l=r(189),f=r(102),y=a(f),h=r(287),v=a(h),b=r(1382),x=r(607),w=r(27),m=y.default.prefix;t.default=(0,v.default)(x.model,{namespace:"resource",state:{list:[],rightSiderFold:!0,rightSiderNodeId:"",selectedRowKeys:[],selectedRows:[],detailModalVisible:!1,types:{},typeDetail:{},selectedInstanceAttrs:[],metaAttrs:{},selectedMetaAttrs:[],selectedActionAttrs:[],rsc:{},rscRestrictionModalVisible:!1,restrictions:null,rscRestrictionModalTitle:"",rscMigrationModalVisible:!1,mainLockVisible:!1},subscriptions:{setup:function(e){var t=e.dispatch;e.history.listen(function(e){var r=e.pathname;"/resource"!==r&&"/"!==r||t({type:"firstQuery"}).then(function(){var e=window.localStorage.getItem(m+"autoReFreshId")?window.localStorage.getItem(m+"autoReFreshId"):"0",r=0;t({type:"cluster/queryHeartBeatStatus"}),"0"!==e&&(r=(0,w.triggerTimedTask)(t,e),t({type:"app/switchAutoReFreshState",payload:{autoReFreshId:e,autoReFreshTaskId:r}}))}).catch(function(e){"\u8bf7\u68c0\u67e5HA\u96c6\u7fa4\u662f\u5426\u5904\u4e8e\u542f\u52a8\u72b6\u6001\uff01"===e.message&&t({type:"updateState",payload:{mainLockVisible:!0}})})})}},effects:{firstQuery:p.default.mark(function e(t,r){var a,n,u=t.payload,s=r.call,c=r.put;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s(b.query,(0,l.parse)(u));case 2:if(a=e.sent,!(n=(0,w.getDrbdEnable)(a.data))){e.next=7;break}return e.next=7,c({type:"queryDrbdStatus"});case 7:return e.next=9,c({type:"updateState",payload:{rawlist:a.data}});case 9:return e.next=11,c({type:"preprocessingState"});case 11:case"end":return e.stop()}},e,this)}),query:p.default.mark(function e(t,r){var a,n,u=t.payload,s=r.call,c=r.put;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,s(b.query,(0,l.parse)(u));case 3:if(a=e.sent,!(n=(0,w.getDrbdEnable)(a.data))){e.next=8;break}return e.next=8,c({type:"queryDrbdStatus"});case 8:return e.next=10,c({type:"updateState",payload:{rawlist:a.data,mainLockVisible:!1}});case 10:return e.next=12,c({type:"preprocessingState"});case 12:e.next=19;break;case 14:if(e.prev=14,e.t0=e.catch(0),"\u8bf7\u68c0\u67e5HA\u96c6\u7fa4\u662f\u5426\u5904\u4e8e\u542f\u52a8\u72b6\u6001\uff01"!==e.t0.message){e.next=19;break}return e.next=19,c({type:"updateState",payload:{mainLockVisible:!0}});case 19:case"end":return e.stop()}},e,this,[[0,14]])}),create:p.default.mark(function e(t,r){var a=t.payload,n=r.call;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n(b.create,(0,l.parse)(a));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}),detail:p.default.mark(function e(t,r){var a,n,u,s,d,o,f,y=t.payload,h=r.call,v=r.put,x=r.select,w=r.take;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h(b.detail,(0,l.parse)(y));case 2:return a=e.sent,n=a.data,e.next=6,v({type:"updateState",payload:{rsc:n}});case 6:if(!n.meta_attributes){e.next=11;break}return u=[],(0,i.default)(n.meta_attributes).forEach(function(e){u.push(e)}),e.next=11,v({type:"updateState",payload:{selectedMetaAttrs:u}});case 11:if("primitive"===n.category){e.next=13;break}return e.abrupt("return",c.default.resolve());case 13:return e.next=15,v({type:"queryRscType",payload:{class:n.class,provider:n.provider,type:n.type}});case 15:return e.next=17,w("queryRscType/@@end");case 17:return e.next=19,x(function(e){return e.resource});case 19:if(s=e.sent,d=s.typeDetail,!n.instance_attributes){e.next=26;break}return o=[],d.parameters&&d.parameters.forEach(function(e){"1"!==e.required&&n.instance_attributes[e.name]&&o.push(e.name)}),e.next=26,v({type:"updateState",payload:{selectedInstanceAttrs:o}});case 26:if(!n.actions){e.next=31;break}return f=[],n.actions.forEach(function(e){f.push(e.name)}),e.next=31,v({type:"updateState",payload:{selectedActionAttrs:f}});case 31:return e.abrupt("return",c.default.resolve());case 32:case"end":return e.stop()}},e,this)}),update:p.default.mark(function e(t,r){var a=t.payload,n=r.call;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n(b.update,(0,l.parse)(a));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}),operate:p.default.mark(function e(t,r){var a=t.payload,n=r.call;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n(b.operate,(0,l.parse)(a));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}),queryRscTypes:p.default.mark(function e(t,r){var a,n=t.payload,u=r.call,s=r.put;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u(b.queryRscTypes,(0,l.parse)(n));case 2:return a=e.sent,e.next=5,s({type:"updateState",payload:{types:a.data}});case 5:case"end":return e.stop()}},e,this)}),queryRscType:p.default.mark(function e(t,r){var a,n=t.payload,u=r.call,s=r.put;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u(b.queryRscType,(0,l.parse)(n));case 2:return a=e.sent,(0,w.transformData)(a.data.parameters),e.next=6,s({type:"updateState",payload:{typeDetail:a.data}});case 6:return e.abrupt("return",c.default.resolve(a.data));case 7:case"end":return e.stop()}},e,this)}),queryRscAttrs:p.default.mark(function e(t,r){var a,n=t.payload,u=r.call,s=r.put;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u(b.queryRscAttrs,(0,l.parse)(n));case 2:return a=e.sent,(0,w.transformData)(a.data),e.next=6,s({type:"updateState",payload:{metaAttrs:a.data}});case 6:case"end":return e.stop()}},e,this)}),queryRscRestriction:p.default.mark(function e(t,r){var a,n=t.payload,u=r.call,s=r.put;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u(b.queryRscRestriction,(0,l.parse)(n));case 2:return a=e.sent,"location"===n.relation&&a.data.node_level.forEach(function(e){a.data[e.level]||(a.data[e.level]=[]),a.data[e.level].push(e.node)}),e.next=6,s({type:"updateState",payload:{restrictions:a.data}});case 6:case"end":return e.stop()}},e,this)}),queryDrbdStatus:p.default.mark(function e(t,r){var a,n=r.call,u=r.put;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n(b.queryDrbdStatus);case 2:return a=e.sent,e.next=5,u({type:"updateListWithDrbdStatus",payload:{drbdStatus:a.data.code,drbdMsg:a.data.message}});case 5:case"end":return e.stop()}},e,this)})},reducers:{clearSelectedRows:function(e){var t={selectedRowKeys:[],selectedRows:[]};return(0,u.default)({},e,t)},preprocessingState:function(e){var t=[],r=e.selectedRowKeys,a=e.selectedRows[0];return e.list=e.rawlist,e.list.forEach(function(e){a&&a.id===e.id&&(t=[e]),e.key=e.id,e.children=e.subrscs,e.children&&e.children.forEach(function(r){a&&a.id===r.id&&(t=[r]),r.isChild=!0,r.children=r.subrscs,r.key=r.id+"-"+e.id,r.children&&r.children.forEach(function(n){a&&a.id===n.id&&(t=[n]),n.isChild=!0,n.key=n.id+"-"+r.id+"-"+e.id})})}),0===t.length&&(r=[]),(0,u.default)({},e,{selectedRows:t,selectedRowKeys:r})},updateListWithDrbdStatus:function(e,t){var r=t.payload,a=r.drbdStatus,n=r.drbdMsg;return e.list.forEach(function(e){"0"===a||"group-fs-ps"!==e.id&&"ms-drbd"!==e.id||(e.drbdStatus=a,e.drbdMsg=n)}),(0,u.default)({},e)}}}),e.exports=t.default},1382:function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.queryDrbdStatus=t.queryRscRestriction=t.create=t.queryRscAttrs=t.queryRscType=t.queryRscTypes=t.operate=t.update=t.detail=t.query=void 0;var n=r(119),u=a(n),s=r(286),c=a(s),d=(t.query=function(){var e=(0,c.default)(u.default.mark(function e(t){return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)({url:o,method:"get",data:t}));case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),t.detail=function(){var e=(0,c.default)(u.default.mark(function e(t){return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)({url:p,method:"get",data:t}));case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),t.update=function(){var e=(0,c.default)(u.default.mark(function e(t){return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)({url:p,method:"put",data:t}));case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),t.operate=function(){var e=(0,c.default)(u.default.mark(function e(t){return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)({url:p+"/:action",method:"put",data:t}));case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),t.queryRscTypes=function(){var e=(0,c.default)(u.default.mark(function e(t){return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)({url:l,method:"get",data:t}));case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),t.queryRscType=function(){var e=(0,c.default)(u.default.mark(function e(t){return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)({url:f,method:"get",data:t}));case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),t.queryRscAttrs=function(){var e=(0,c.default)(u.default.mark(function e(t){return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)({url:y,method:"get",data:t}));case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),t.create=function(){var e=(0,c.default)(u.default.mark(function e(t){return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)({url:o,method:"post",data:t}));case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),t.queryRscRestriction=function(){var e=(0,c.default)(u.default.mark(function e(t){return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)({url:p+"/relations/:relation",method:"get",data:t}));case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),t.queryDrbdStatus=function(){var e=(0,c.default)(u.default.mark(function e(t){return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)({url:h,method:"get",data:t}));case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),r(27)),i=d.config.api,o=i.resources,p=i.resource,l=i.rscTypes,f=i.rscType,y=i.rscAttrs,h=i.drbdStatus}});